<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rudy::AWS::EC2::Instances [Rudy: Not your grandparents' EC2 deployment tool.]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Module</span>
          Rudy::AWS::EC2::Instances
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../../files/lib/rudy/aws/ec2/instance_rb.html">lib/rudy/aws/ec2/instance.rb</a>
          </li>
        </ol>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000079">from_hash</a></li>
              <li><a href="#M000080">known_state?</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000071">any?</a></li>
              <li><a href="#M000073">any_group?</a></li>
              <li><a href="#M000067">attached_volume?</a></li>
              <li><a href="#M000066">console</a></li>
              <li><a href="#M000057">create</a></li>
              <li><a href="#M000059">destroy</a></li>
              <li><a href="#M000061">destroy_group</a></li>
              <li><a href="#M000069">device_volume</a></li>
              <li><a href="#M000072">exists?</a></li>
              <li><a href="#M000070">get</a></li>
              <li><a href="#M000062">list</a></li>
              <li><a href="#M000065">list_as_hash</a></li>
              <li><a href="#M000063">list_group</a></li>
              <li><a href="#M000064">list_group_as_hash</a></li>
              <li><a href="#M000075">pending?</a></li>
              <li><a href="#M000058">restart</a></li>
              <li><a href="#M000060">restart_group</a></li>
              <li><a href="#M000074">running?</a></li>
              <li><a href="#M000077">shutting_down?</a></li>
              <li><a href="#M000076">terminated?</a></li>
              <li><a href="#M000078">unavailable?</a></li>
              <li><a href="#M000068">volumes</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li><a href="../EC2.html">Rudy::AWS::EC2</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>KNOWN_STATES</td>
                    <td>=</td>
                    <td class='context-item-value'>[:running, :pending, :shutting_down, :terminated, :degraded].freeze</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M000079'>
                <a name='M000079'>      </a>
                <div class='synopsis'>
                  <span class='name'>from_hash</span>
                  <span class='arguments'>(h)</span>
                </div>
                <div class='description'>
                  <p>
                  <tt>h</tt> is a hash of instance properties in the format returned by
                  EC2::Base#describe_instances:
                  </p>
                  <pre>kernelId: aki-9b00e5f2&#x000A;amiLaunchIndex: &quot;0&quot;&#x000A;keyName: solutious-default&#x000A;launchTime: &quot;2009-03-14T12:48:15.000Z&quot;&#x000A;instanceType: m1.small&#x000A;imageId: ami-0734d36e&#x000A;privateDnsName:&#x000A;reason:&#x000A;placement:&#x000A;  availabilityZone: us-east-1b&#x000A;dnsName:&#x000A;instanceId: i-cdaa34a4&#x000A;instanceState:&#x000A;  name: pending&#x000A;  code: &quot;0&quot;</pre>
                  <p>
                  Returns an <a href="Instance.html">Instance</a> object.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000079-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000079-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 344</span>&#x000A;344:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">h</span>)&#x000A;345:         <span class="ruby-identifier">inst</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span><span class="ruby-operator">::</span><span class="ruby-constant">Instance</span>.<span class="ruby-identifier">new</span>&#x000A;346:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">aki</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'kernelId'</span>]&#x000A;347:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">ami</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'imageId'</span>]&#x000A;348:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">created</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'launchTime'</span>]&#x000A;349:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">keyname</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'keyName'</span>]&#x000A;350:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">launch_index</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'amiLaunchIndex'</span>]&#x000A;351:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">size</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'instanceType'</span>]&#x000A;352:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">dns_private</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'privateDnsName'</span>]&#x000A;353:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">dns_public</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'dnsName'</span>]&#x000A;354:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">reason</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'reason'</span>]&#x000A;355:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">zone</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'placement'</span>][<span class="ruby-value str">'availabilityZone'</span>]&#x000A;356:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">awsid</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'instanceId'</span>]&#x000A;357:         <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> = <span class="ruby-identifier">h</span>[<span class="ruby-value str">'instanceState'</span>][<span class="ruby-value str">'name'</span>]&#x000A;358:         <span class="ruby-identifier">inst</span>&#x000A;359:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-M000080'>
                <a name='M000080'>      </a>
                <div class='synopsis'>
                  <span class='name'>known_state?</span>
                  <span class='arguments'>(state)</span>
                </div>
                <div class='description'>
                  <p>
                  Is <tt>state</tt> a known <a href="../EC2.html">EC2</a> machine instance
                  state? See: KNOWN_STATES
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000080-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000080-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 362</span>&#x000A;362:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">known_state?</span>(<span class="ruby-identifier">state</span>)&#x000A;363:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">state</span>&#x000A;364:         <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">to_sym</span>&#x000A;365:         <span class="ruby-identifier">state</span> = <span class="ruby-identifier">:shutting_down</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:'shutting-down'</span>&#x000A;366:         <span class="ruby-constant">KNOWN_STATES</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">state</span>)&#x000A;367:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000071'>
                <a name='M000071'>      </a>
                <div class='synopsis'>
                  <span class='name'>any?</span>
                  <span class='arguments'>(state=:any, inst_ids=[])</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000071-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000071-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 287</span>&#x000A;287:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">any?</span>(<span class="ruby-identifier">state</span>=<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_ids</span>=[])&#x000A;288:         <span class="ruby-operator">!</span><span class="ruby-identifier">list</span>(<span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>).<span class="ruby-identifier">nil?</span>&#x000A;289:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000073'>
                <a name='M000073'>      </a>
                <div class='synopsis'>
                  <span class='name'>any_group?</span>
                  <span class='arguments'>(group=nil, state=:any)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000073-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000073-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 295</span>&#x000A;295:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">any_group?</span>(<span class="ruby-identifier">group</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">state</span>=<span class="ruby-identifier">:any</span>)&#x000A;296:         <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">state</span>)&#x000A;297:         <span class="ruby-operator">!</span><span class="ruby-identifier">ret</span>.<span class="ruby-identifier">nil?</span>&#x000A;298:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000067'>
                <a name='M000067'>      </a>
                <div class='synopsis'>
                  <span class='name'>attached_volume?</span>
                  <span class='arguments'>(id, device)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000067-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000067-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 258</span>&#x000A;258:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">attached_volume?</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">device</span>)&#x000A;259:         <span class="ruby-identifier">list</span> = <span class="ruby-identifier">volumes</span>(<span class="ruby-identifier">id</span>)&#x000A;260:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;261:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">device</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">device</span>&#x000A;262:         <span class="ruby-keyword kw">end</span>&#x000A;263:         <span class="ruby-keyword kw">false</span>&#x000A;264:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000066'>
                <a name='M000066'>      </a>
                <div class='synopsis'>
                  <span class='name'>console</span>
                  <span class='arguments'>(inst_id, &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <p>
                  System console output.
                  </p>
                  <ul>
                  <li><tt>inst_id</tt> instance ID (String) or <a
                  href="Instance.html">Instance</a> object.
                  
                  </li>
                  </ul>
                  <p>
                  NOTE: Amazon sends the console outputs as a Base64 encoded string. This
                  method DOES NOT decode in order to remain compliant with the data formats
                  returned by Amazon.
                  </p>
                  <p>
                  You can decode it like this:
                  </p>
                  <pre>require 'base64'&#x000A;Base64.decode64(output)</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000066-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000066-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 250</span>&#x000A;250:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">console</span>(<span class="ruby-identifier">inst_id</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;251:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>([<span class="ruby-identifier">inst_id</span>])&#x000A;252:         <span class="ruby-identifier">response</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span>.<span class="ruby-identifier">execute_request</span>({}) { &#x000A;253:           <span class="ruby-ivar">@@ec2</span>.<span class="ruby-identifier">get_console_output</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>.<span class="ruby-identifier">first</span>)&#x000A;254:         }&#x000A;255:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'output'</span>]&#x000A;256:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000057'>
                <a name='M000057'>      </a>
                <div class='synopsis'>
                  <span class='name'>create</span>
                  <span class='arguments'>(opts={}, &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <p>
                  Return an Array of <a href="Instance.html">Instance</a> objects. Note:
                  These objects will not have DNS data because they will still be in pending
                  state. The DNS info becomes available once the instance enters the running
                  state.
                  </p>
                  <p>
                  <tt>opts</tt> supports the following parameters:
                  </p>
                  <ul>
                  <li><tt>:zone</tt>
                  
                  </li>
                  <li><tt>:ami</tt>
                  
                  </li>
                  <li><tt>:group</tt>
                  
                  </li>
                  <li><tt>:size</tt>
                  
                  </li>
                  <li><tt>:keypair</tt>
                  
                  </li>
                  <li><tt>:private</tt> true or false (default)
                  
                  </li>
                  <li><tt>:machine_data</tt>
                  
                  </li>
                  <li><tt>:min</tt> count
                  
                  </li>
                  <li><tt>:max</tt> count
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000057-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000057-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 65</span>&#x000A;65:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;66:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoAMI</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:ami</span>]&#x000A;67:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoGroup</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]&#x000A;68:         &#x000A;69:         <span class="ruby-identifier">opts</span> = {&#x000A;70:           <span class="ruby-identifier">:size</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'m1.small'</span>,&#x000A;71:           <span class="ruby-identifier">:min</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>,&#x000A;72:           <span class="ruby-identifier">:max</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>&#x000A;73:         }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>)&#x000A;74:         &#x000A;75:         <span class="ruby-identifier">old_opts</span> = {&#x000A;76:           <span class="ruby-identifier">:image_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:ami</span>].<span class="ruby-identifier">to_s</span>,&#x000A;77:           <span class="ruby-identifier">:min_count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:min</span>],&#x000A;78:           <span class="ruby-identifier">:max_count</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:max</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:min</span>],&#x000A;79:           <span class="ruby-identifier">:key_name</span> =<span class="ruby-operator">&gt;</span> (<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:keypair</span>] <span class="ruby-operator">||</span> <span class="ruby-value str">''</span>).<span class="ruby-identifier">to_s</span>,&#x000A;80:           <span class="ruby-identifier">:security_group</span> =<span class="ruby-operator">&gt;</span> [<span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:group</span>]].<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">compact</span>,&#x000A;81:           <span class="ruby-comment cmt">#:user_data =&gt; opts[:machine_data],  # Error: Invalid BASE64 encoding of user data ??</span>&#x000A;82:           <span class="ruby-identifier">:availability_zone</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:zone</span>].<span class="ruby-identifier">to_s</span>,&#x000A;83:           <span class="ruby-identifier">:instance_type</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-identifier">:size</span>].<span class="ruby-identifier">to_s</span>,&#x000A;84:           <span class="ruby-identifier">:kernel_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">nil</span>&#x000A;85:         }&#x000A;86:         &#x000A;87:         <span class="ruby-identifier">response</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span>.<span class="ruby-identifier">execute_request</span>({}) { <span class="ruby-ivar">@@ec2</span>.<span class="ruby-identifier">run_instances</span>(<span class="ruby-identifier">old_opts</span>) }&#x000A;88:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;89:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span>&#x000A;90:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">inst</span>)&#x000A;91:         <span class="ruby-keyword kw">end</span>&#x000A;92:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> &#x000A;93:           <span class="ruby-identifier">each_inst</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">inst</span>) &#x000A;94:         } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">each_inst</span>&#x000A;95:         <span class="ruby-identifier">instances</span>&#x000A;96:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000059'>
                <a name='M000059'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy</span>
                  <span class='arguments'>(inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000059-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000059-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 108</span>&#x000A;108:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;109:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:running</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> [] &#x000A;110:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoRunningInstances</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span>&#x000A;111:       &#x000A;112:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;113:             &#x000A;114:         <span class="ruby-identifier">response</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span>.<span class="ruby-identifier">execute_request</span>({}) {&#x000A;115:           <span class="ruby-ivar">@@ec2</span>.<span class="ruby-identifier">terminate_instances</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>)&#x000A;116:         }&#x000A;117:       &#x000A;118:         <span class="ruby-comment cmt">#instancesSet: </span>&#x000A;119:         <span class="ruby-comment cmt">#  item: </span>&#x000A;120:         <span class="ruby-comment cmt">#  - instanceId: i-ebdcb882</span>&#x000A;121:         <span class="ruby-comment cmt">#    shutdownState: </span>&#x000A;122:         <span class="ruby-comment cmt">#      code: &quot;48&quot;</span>&#x000A;123:         <span class="ruby-comment cmt">#      name: terminated</span>&#x000A;124:         <span class="ruby-comment cmt">#    previousState: </span>&#x000A;125:         <span class="ruby-comment cmt">#      code: &quot;48&quot;</span>&#x000A;126:         <span class="ruby-comment cmt">#      name: terminated</span>&#x000A;127:       &#x000A;128:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedResponse</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;129:         <span class="ruby-identifier">instances_shutdown</span> = []&#x000A;130:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'instancesSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span>&#x000A;131:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">inst</span>[<span class="ruby-value str">'shutdownState'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">inst</span>[<span class="ruby-value str">'shutdownState'</span>][<span class="ruby-value str">'name'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'shutting-down'</span>&#x000A;132:           <span class="ruby-identifier">instances_shutdown</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">inst</span>[<span class="ruby-value str">'instanceId'</span>]&#x000A;133:         <span class="ruby-keyword kw">end</span>&#x000A;134:         <span class="ruby-identifier">success</span> = <span class="ruby-identifier">instances_shutdown</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">inst_ids</span>.<span class="ruby-identifier">size</span>&#x000A;135:         <span class="ruby-identifier">success</span>&#x000A;136:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000061'>
                <a name='M000061'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy_group</span>
                  <span class='arguments'>(group, &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000061-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000061-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 144</span>&#x000A;144:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;145:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">:running</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> []&#x000A;146:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">instances</span>)&#x000A;147:         <span class="ruby-identifier">destroy</span>(<span class="ruby-identifier">inst_ids</span>, <span class="ruby-identifier">:skip_check</span>)&#x000A;148:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000069'>
                <a name='M000069'>      </a>
                <div class='synopsis'>
                  <span class='name'>device_volume</span>
                  <span class='arguments'>(id, device)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000069-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000069-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 273</span>&#x000A;273:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">device_volume</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">device</span>)&#x000A;274:         <span class="ruby-identifier">volumes</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">device</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">device</span> }&#x000A;275:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000072'>
                <a name='M000072'>      </a>
                <div class='synopsis'>
                  <span class='name'>exists?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000072-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000072-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 291</span>&#x000A;291:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;292:         <span class="ruby-identifier">any?</span>(<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_ids</span>)&#x000A;293:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000070'>
                <a name='M000070'>      </a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(inst_id)</span>
                </div>
                <div class='description'>
                  <p>
                  <tt>inst_id</tt> is an instance ID Returns an <a
                  href="Instance.html">Instance</a> object
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000070-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000070-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 279</span>&#x000A;279:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get</span>(<span class="ruby-identifier">inst_id</span>)&#x000A;280:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">inst_id</span>.<span class="ruby-identifier">nil?</span>&#x000A;281:         <span class="ruby-identifier">inst_id</span> = <span class="ruby-identifier">inst_id</span>.<span class="ruby-identifier">awsid</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">inst_id</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span><span class="ruby-operator">::</span><span class="ruby-constant">Instance</span>)&#x000A;282:         <span class="ruby-identifier">inst</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_id</span>) &#x000A;283:         <span class="ruby-identifier">inst</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">first</span>&#x000A;284:         <span class="ruby-identifier">inst</span>&#x000A;285:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000062'>
                <a name='M000062'>      </a>
                <div class='synopsis'>
                  <span class='name'>list</span>
                  <span class='arguments'>(state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>state</tt> is an optional instance state. If specified, must be one of:
                  running (default), pending, terminated.
                  
                  </li>
                  <li><tt>inst_ids</tt> is an Array of instance IDs.
                  
                  </li>
                  </ul>
                  <p>
                  Returns an Array of <a href="Instance.html">Rudy::AWS::EC2::Instance</a>
                  objects.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000062-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000062-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 153</span>&#x000A;153:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list</span>(<span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;154:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_as_hash</span>(<span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;155:         <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">values</span>&#x000A;156:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;157:         <span class="ruby-identifier">instances</span>&#x000A;158:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000065'>
                <a name='M000065'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_as_hash</span>
                  <span class='arguments'>(state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>state</tt> is an optional instance state. If specified, must be
                  
                  </li>
                  </ul>
                  <p>
                  one of: running (default), pending, terminated, any
                  </p>
                  <ul>
                  <li><tt>inst_ids</tt> is an Array of instance IDs or <a
                  href="Instance.html">Rudy::AWS::EC2::Instance</a> objects.
                  
                  </li>
                  </ul>
                  <p>
                  Returns a <a href="../../../Hash.html">Hash</a> of <a
                  href="Instance.html">Rudy::AWS::EC2::Instance</a> objects. The key is the
                  instance ID.
                  </p>
                  <ul>
                  <li><tt>each_inst</tt> a block to execute for every instance in the list.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000065-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000065-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 190</span>&#x000A;190:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_as_hash</span>(<span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;191:         <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">to_sym</span>&#x000A;192:         <span class="ruby-identifier">state</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:any</span>&#x000A;193:         <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Unknown state: #{state}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-constant">Instances</span>.<span class="ruby-identifier">known_state?</span>(<span class="ruby-identifier">state</span>)&#x000A;194:         <span class="ruby-identifier">state</span> = <span class="ruby-identifier">:'shutting-down'</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:shutting_down</span> <span class="ruby-comment cmt"># EC2 uses a dash</span>&#x000A;195: &#x000A;196:         <span class="ruby-comment cmt"># If we got Instance objects, we want just the IDs.</span>&#x000A;197:         <span class="ruby-comment cmt"># This method always returns an Array.</span>&#x000A;198:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;199:       &#x000A;200:         <span class="ruby-identifier">response</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span>.<span class="ruby-identifier">execute_request</span>({}) {&#x000A;201:           <span class="ruby-ivar">@@ec2</span>.<span class="ruby-identifier">describe_instances</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>)&#x000A;202:         }&#x000A;203:       &#x000A;204:         <span class="ruby-comment cmt"># requestId: c16878ac-28e4-4859-9878-ef93af45789c</span>&#x000A;205:         <span class="ruby-comment cmt"># reservationSet: </span>&#x000A;206:         <span class="ruby-comment cmt">#   item: </span>&#x000A;207:         <span class="ruby-comment cmt">#   - reservationId: r-e493148d</span>&#x000A;208:         <span class="ruby-comment cmt">#     groupSet: </span>&#x000A;209:         <span class="ruby-comment cmt">#       item: </span>&#x000A;210:         <span class="ruby-comment cmt">#       - groupId: default</span>&#x000A;211:         <span class="ruby-comment cmt">#     instancesSet: </span>&#x000A;212:         <span class="ruby-comment cmt">#       item:</span>&#x000A;213:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">response</span>[<span class="ruby-value str">'reservationSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)  <span class="ruby-comment cmt"># No instances </span>&#x000A;214:       &#x000A;215:         <span class="ruby-identifier">resids</span> = []&#x000A;216:         <span class="ruby-identifier">instances</span> = {}&#x000A;217:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'reservationSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">res</span><span class="ruby-operator">|</span>      &#x000A;218:           <span class="ruby-identifier">resids</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">res</span>[<span class="ruby-value str">'reservationId'</span>]&#x000A;219:           <span class="ruby-identifier">groups</span> = <span class="ruby-identifier">res</span>[<span class="ruby-value str">'groupSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">g</span><span class="ruby-operator">|</span> <span class="ruby-identifier">g</span>[<span class="ruby-value str">'groupId'</span>] }&#x000A;220:           <span class="ruby-comment cmt"># And each reservation can have 1 or more instances</span>&#x000A;221:           <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">res</span>[<span class="ruby-value str">'instancesSet'</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)&#x000A;222:           <span class="ruby-identifier">res</span>[<span class="ruby-value str">'instancesSet'</span>][<span class="ruby-value str">'item'</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">props</span><span class="ruby-operator">|</span>&#x000A;223:             <span class="ruby-identifier">inst</span> = <span class="ruby-constant">Instances</span>.<span class="ruby-identifier">from_hash</span>(<span class="ruby-identifier">props</span>)&#x000A;224:             <span class="ruby-keyword kw">next</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">state</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">to_s</span>&#x000A;225:             <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">groups</span> = <span class="ruby-identifier">groups</span>&#x000A;226:             <span class="ruby-comment cmt">#puts &quot;STATE: #{inst.state} #{state}&quot;</span>&#x000A;227:             <span class="ruby-identifier">instances</span>[<span class="ruby-identifier">inst</span>.<span class="ruby-identifier">awsid</span>] = <span class="ruby-identifier">inst</span>&#x000A;228:           <span class="ruby-keyword kw">end</span>&#x000A;229:         <span class="ruby-keyword kw">end</span>&#x000A;230:         &#x000A;231:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">each_value</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> <span class="ruby-identifier">each_inst</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">inst</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">each_inst</span>&#x000A;232:         &#x000A;233:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;234:         <span class="ruby-identifier">instances</span>&#x000A;235:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000063'>
                <a name='M000063'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_group</span>
                  <span class='arguments'>(group=nil, state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>group</tt> is a security group name.
                  
                  </li>
                  <li><tt>state</tt> is an optional instance state. If specified, must be one of:
                  running (default), pending, terminated.
                  
                  </li>
                  <li><tt>inst_ids</tt> is an Array of instance IDs.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000063-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000063-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 163</span>&#x000A;163:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;164:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_group_as_hash</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;165:         <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;=</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">values</span>&#x000A;166:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;167:         <span class="ruby-identifier">instances</span>&#x000A;168:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000064'>
                <a name='M000064'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_group_as_hash</span>
                  <span class='arguments'>(group=nil, state=nil, inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='description'>
                  <ul>
                  <li><tt>group</tt> is a security group name.
                  
                  </li>
                  <li><tt>state</tt> is an optional instance state. If specified, must be one of:
                  running (default), pending, terminated.
                  
                  </li>
                  <li><tt>inst_ids</tt> is an Array of instance IDs.
                  
                  </li>
                  </ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000064-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000064-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 174</span>&#x000A;174:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_group_as_hash</span>(<span class="ruby-identifier">group</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">state</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;175:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_as_hash</span>(<span class="ruby-identifier">state</span>, <span class="ruby-identifier">inst_ids</span>)&#x000A;176:         <span class="ruby-comment cmt"># Remove instances that are not in the specified group</span>&#x000A;177:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>&#x000A;178:           <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">id</span>,<span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">inst</span>.<span class="ruby-identifier">groups</span>.<span class="ruby-identifier">member?</span>(<span class="ruby-identifier">group</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">group</span>&#x000A;179:           <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">each_value</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> <span class="ruby-identifier">each_inst</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">inst</span>) } <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">each_inst</span>&#x000A;180:         <span class="ruby-keyword kw">end</span>&#x000A;181:         <span class="ruby-identifier">instances</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-comment cmt"># Don't return an empty hash</span>&#x000A;182:         <span class="ruby-identifier">instances</span>&#x000A;183:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000075'>
                <a name='M000075'>      </a>
                <div class='synopsis'>
                  <span class='name'>pending?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000075-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000075-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 303</span>&#x000A;303:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pending?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;304:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:pending</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;305:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000058'>
                <a name='M000058'>      </a>
                <div class='synopsis'>
                  <span class='name'>restart</span>
                  <span class='arguments'>(inst_ids=[], &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000058-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000058-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 98</span>&#x000A; 98:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">restart</span>(<span class="ruby-identifier">inst_ids</span>=[], <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A; 99:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:running</span>, <span class="ruby-identifier">inst_ids</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> []&#x000A;100:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoRunningInstances</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">empty?</span>&#x000A;101:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;102:         <span class="ruby-identifier">response</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span>.<span class="ruby-identifier">execute_request</span>({}) {&#x000A;103:           <span class="ruby-ivar">@@ec2</span>.<span class="ruby-identifier">reboot_instances</span>(<span class="ruby-identifier">:instance_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inst_ids</span>)&#x000A;104:         }&#x000A;105:         <span class="ruby-identifier">response</span>[<span class="ruby-value str">'return'</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">'true'</span>&#x000A;106:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000060'>
                <a name='M000060'>      </a>
                <div class='synopsis'>
                  <span class='name'>restart_group</span>
                  <span class='arguments'>(group, &amp;each_inst)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000060-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000060-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 138</span>&#x000A;138:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">restart_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>)&#x000A;139:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list_group</span>(<span class="ruby-identifier">group</span>, <span class="ruby-identifier">:running</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">each_inst</span>) <span class="ruby-operator">||</span> []&#x000A;140:         <span class="ruby-identifier">inst_ids</span> = <span class="ruby-identifier">objects_to_instance_ids</span>(<span class="ruby-identifier">instances</span>)&#x000A;141:         <span class="ruby-identifier">restart</span>(<span class="ruby-identifier">inst_ids</span>, <span class="ruby-identifier">:skip_check</span>)&#x000A;142:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000074'>
                <a name='M000074'>      </a>
                <div class='synopsis'>
                  <span class='name'>running?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000074-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000074-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 300</span>&#x000A;300:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">running?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;301:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:running</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;302:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000077'>
                <a name='M000077'>      </a>
                <div class='synopsis'>
                  <span class='name'>shutting_down?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000077-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000077-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 309</span>&#x000A;309:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">shutting_down?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;310:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:shutting_down</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;311:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000076'>
                <a name='M000076'>      </a>
                <div class='synopsis'>
                  <span class='name'>terminated?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000076-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000076-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 306</span>&#x000A;306:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">terminated?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;307:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">list</span>(<span class="ruby-identifier">:terminated</span>, <span class="ruby-identifier">inst_ids</span>), <span class="ruby-identifier">inst_ids</span>)&#x000A;308:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000078'>
                <a name='M000078'>      </a>
                <div class='synopsis'>
                  <span class='name'>unavailable?</span>
                  <span class='arguments'>(inst_ids)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000078-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000078-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 313</span>&#x000A;313:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unavailable?</span>(<span class="ruby-identifier">inst_ids</span>)&#x000A;314:         <span class="ruby-identifier">instances</span> = <span class="ruby-identifier">list</span>(<span class="ruby-identifier">:any</span>, <span class="ruby-identifier">inst_ids</span>) <span class="ruby-operator">||</span> []&#x000A;315:         <span class="ruby-identifier">instances</span>.<span class="ruby-identifier">reject!</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">inst</span><span class="ruby-operator">|</span> &#x000A;316:           (<span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;shutting-down&quot;</span> <span class="ruby-operator">||</span> &#x000A;317:            <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;pending&quot;</span> <span class="ruby-operator">||</span> &#x000A;318:            <span class="ruby-identifier">inst</span>.<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;terminated&quot;</span>) &#x000A;319:         }&#x000A;320:         <span class="ruby-identifier">compare_instance_lists</span>(<span class="ruby-identifier">instances</span>, <span class="ruby-identifier">inst_ids</span>)&#x000A;321:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000068'>
                <a name='M000068'>      </a>
                <div class='synopsis'>
                  <span class='name'>volumes</span>
                  <span class='arguments'>(id)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000068-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000068-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/ec2/instance.rb, line 266</span>&#x000A;266:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">volumes</span>(<span class="ruby-identifier">id</span>)&#x000A;267:         <span class="ruby-identifier">rvol</span> = <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">AWS</span><span class="ruby-operator">::</span><span class="ruby-constant">EC2</span><span class="ruby-operator">::</span><span class="ruby-constant">Volumes</span>.<span class="ruby-identifier">new</span>&#x000A;268:         <span class="ruby-identifier">rvol</span>.<span class="ruby-identifier">ec2</span> = <span class="ruby-ivar">@ec2</span> &#x000A;269:         <span class="ruby-identifier">rvol</span>.<span class="ruby-identifier">list</span> <span class="ruby-operator">||</span> []&#x000A;270:         <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">attached?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">instid</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">id</span> }&#x000A;271:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
