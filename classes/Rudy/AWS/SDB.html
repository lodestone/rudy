<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rudy::AWS::SDB [Rudy: Not your grandparents' EC2 deployment tool.]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Rudy::AWS::SDB
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../files/lib/rudy/aws/sdb/error_rb.html">lib/rudy/aws/sdb/error.rb</a>
          </li>
          <li class='other'>
            <a href="../../../files/lib/rudy/aws/sdb_rb.html">lib/rudy/aws/sdb.rb</a>
          </li>
          <li>
            <a class='show' href='#' onclick='this.parentNode.parentNode.className += " expanded"; this.parentNode.removeChild(this); return false'>show all</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000154">generate_select</a></li>
              <li><a href="#M000150">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000152">create_domain</a></li>
              <li><a href="#M000160">delete_attributes</a></li>
              <li><a href="#M000161">destroy</a></li>
              <li><a href="#M000153">destroy_domain</a></li>
              <li><a href="#M000159">get</a></li>
              <li><a href="#M000158">get_attributes</a></li>
              <li><a href="#M000151">list_domains</a></li>
              <li><a href="#M000157">put</a></li>
              <li><a href="#M000156">put_attributes</a></li>
              <li><a href="#M000155">select</a></li>
            </ol>
            <h3>protected instance</h3>
            <ol>
              <li><a href="#M000163">call</a></li>
              <li><a href="#M000162">execute_request</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Class <a href="SDB/ConnectionError.html" class="link">Rudy::AWS::SDB::ConnectionError</a><br />
              Class <a href="SDB/Error.html" class="link">Rudy::AWS::SDB::Error</a><br />
              Class <a href="SDB/FeatureDeprecatedError.html" class="link">Rudy::AWS::SDB::FeatureDeprecatedError</a><br />
              Class <a href="SDB/InvalidDomainNameError.html" class="link">Rudy::AWS::SDB::InvalidDomainNameError</a><br />
              Class <a href="SDB/InvalidNextTokenError.html" class="link">Rudy::AWS::SDB::InvalidNextTokenError</a><br />
              Class <a href="SDB/InvalidNumberPredicatesError.html" class="link">Rudy::AWS::SDB::InvalidNumberPredicatesError</a><br />
              Class <a href="SDB/InvalidNumberValueTestsError.html" class="link">Rudy::AWS::SDB::InvalidNumberValueTestsError</a><br />
              Class <a href="SDB/InvalidParameterValueError.html" class="link">Rudy::AWS::SDB::InvalidParameterValueError</a><br />
              Class <a href="SDB/InvalidQueryExpressionError.html" class="link">Rudy::AWS::SDB::InvalidQueryExpressionError</a><br />
              Class <a href="SDB/MissingParameterError.html" class="link">Rudy::AWS::SDB::MissingParameterError</a><br />
              Class <a href="SDB/NoAccessKey.html" class="link">Rudy::AWS::SDB::NoAccessKey</a><br />
              Class <a href="SDB/NoSecretKey.html" class="link">Rudy::AWS::SDB::NoSecretKey</a><br />
              Class <a href="SDB/NoSuchDomainError.html" class="link">Rudy::AWS::SDB::NoSuchDomainError</a><br />
              Class <a href="SDB/NumberDomainAttributesExceededError.html" class="link">Rudy::AWS::SDB::NumberDomainAttributesExceededError</a><br />
              Class <a href="SDB/NumberDomainBytesExceededError.html" class="link">Rudy::AWS::SDB::NumberDomainBytesExceededError</a><br />
              Class <a href="SDB/NumberDomainsExceededError.html" class="link">Rudy::AWS::SDB::NumberDomainsExceededError</a><br />
              Class <a href="SDB/NumberItemAttributesExceededError.html" class="link">Rudy::AWS::SDB::NumberItemAttributesExceededError</a><br />
              Class <a href="SDB/RequestError.html" class="link">Rudy::AWS::SDB::RequestError</a><br />
              Class <a href="SDB/RequestTimeoutError.html" class="link">Rudy::AWS::SDB::RequestTimeoutError</a><br />
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M000154'>
                <a name='M000154'>      </a>
                <div class='synopsis'>
                  <span class='name'>generate_select</span>
                  <span class='arguments'>(domain, fields={})</span>
                </div>
                <div class='description'>
                  <p>
                  Takes a <a href="../../Hash.html">Hash</a> of criteria. Returns a string
                  suitable for a SimpleDB Select
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000154-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000154-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 67</span>&#x000A;67:       <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">generate_select</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">fields</span>={})&#x000A;68:         <span class="ruby-identifier">query</span> = []&#x000A;69:         <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> &#x000A;70:           <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{Rudy::AWS.escape n}='#{Rudy::AWS.escape v}'&quot;</span>&#x000A;71:         <span class="ruby-keyword kw">end</span>&#x000A;72:         <span class="ruby-identifier">str</span> = <span class="ruby-node">&quot;select * from #{domain} &quot;</span> &#x000A;73:         <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot; where &quot;</span><span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">query</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">' and '</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">query</span>.<span class="ruby-identifier">empty?</span>&#x000A;74:         <span class="ruby-identifier">str</span>&#x000A;75:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-M000150'>
                <a name='M000150'>      </a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(access_key=nil, secret_key=nil, region=nil, debug=nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000150-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000150-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 19</span>&#x000A;19:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">access_key</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">secret_key</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">region</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">debug</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;20:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoAccessKey</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">access_key</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">access_key</span>.<span class="ruby-identifier">empty?</span>&#x000A;21:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">NoSecretKey</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">secret_key</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">secret_key</span>.<span class="ruby-identifier">empty?</span>&#x000A;22:           &#x000A;23:         <span class="ruby-identifier">url</span> <span class="ruby-operator">||=</span> <span class="ruby-value str">'http://sdb.amazonaws.com'</span>&#x000A;24:         <span class="ruby-comment cmt"># There is a bug with passing :server to EC2::Base.new so </span>&#x000A;25:         <span class="ruby-comment cmt"># we'll use the environment variable for now. </span>&#x000A;26:         <span class="ruby-comment cmt">#if region &amp;&amp; Rudy::AWS.valid_region?(region)</span>&#x000A;27:         <span class="ruby-comment cmt">#  &quot;#{region}.sdb.amazonaws.com&quot;</span>&#x000A;28:         <span class="ruby-comment cmt">#end</span>&#x000A;29:         &#x000A;30:         <span class="ruby-ivar">@access_key_id</span> = <span class="ruby-identifier">access_key</span> <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'AWS_ACCESS_KEY'</span>]&#x000A;31:         <span class="ruby-ivar">@secret_access_key</span> = <span class="ruby-identifier">secret_key</span> <span class="ruby-operator">||</span> <span class="ruby-constant">ENV</span>[<span class="ruby-value str">'AWS_SECRET_KEY'</span>]&#x000A;32:         <span class="ruby-ivar">@base_url</span> = <span class="ruby-identifier">url</span>&#x000A;33:         <span class="ruby-ivar">@debug</span> = <span class="ruby-identifier">debug</span> <span class="ruby-operator">||</span> <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>&#x000A;34:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000152'>
                <a name='M000152'>      </a>
                <div class='synopsis'>
                  <span class='name'>create_domain</span>
                  <span class='arguments'>(domain)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000152-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000152-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 51</span>&#x000A;51:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create_domain</span>(<span class="ruby-identifier">domain</span>)&#x000A;52:         <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:post</span>, { <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'CreateDomain'</span>, <span class="ruby-value str">'DomainName'</span>=<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span> })&#x000A;53:         <span class="ruby-keyword kw">true</span>&#x000A;54:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000160'>
                <a name='M000160'>      </a>
                <div class='synopsis'>
                  <span class='name'>delete_attributes</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000160-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000160-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 159</span>&#x000A;159:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">delete_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">item</span>)&#x000A;160:         <span class="ruby-identifier">call</span>(&#x000A;161:           <span class="ruby-identifier">:delete</span>,&#x000A;162:           {&#x000A;163:             <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'DeleteAttributes'</span>,&#x000A;164:             <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>,&#x000A;165:             <span class="ruby-value str">'ItemName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;166:           }&#x000A;167:         )&#x000A;168:         <span class="ruby-keyword kw">true</span>&#x000A;169:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000161'>
                <a name='M000161'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="SDB.html#M000160">delete_attributes</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000153'>
                <a name='M000153'>      </a>
                <div class='synopsis'>
                  <span class='name'>destroy_domain</span>
                  <span class='arguments'>(domain)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000153-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000153-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 56</span>&#x000A;56:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy_domain</span>(<span class="ruby-identifier">domain</span>)&#x000A;57:         <span class="ruby-identifier">call</span>(&#x000A;58:           <span class="ruby-identifier">:delete</span>,&#x000A;59:           { <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'DeleteDomain'</span>, <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span> }&#x000A;60:         )&#x000A;61:         <span class="ruby-keyword kw">true</span>&#x000A;62:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000159'>
                <a name='M000159'>      </a>
                <div class='synopsis'>
                  <span class='name'>get</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="SDB.html#M000158">get_attributes</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000158'>
                <a name='M000158'>      </a>
                <div class='synopsis'>
                  <span class='name'>get_attributes</span>
                  <span class='arguments'>(domain, item)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000158-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000158-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 136</span>&#x000A;136:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">item</span>)&#x000A;137:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(&#x000A;138:           <span class="ruby-identifier">:get</span>,&#x000A;139:           {&#x000A;140:             <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'GetAttributes'</span>,&#x000A;141:             <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>,&#x000A;142:             <span class="ruby-value str">'ItemName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;143:           }&#x000A;144:         )&#x000A;145:         <span class="ruby-identifier">attributes</span> = {}&#x000A;146:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>&#x000A;147:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">&quot;//Attribute&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>&#x000A;148:             <span class="ruby-identifier">key</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;149:             <span class="ruby-identifier">value</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Value/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A;150:             ( <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> [] ) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>&#x000A;151:           <span class="ruby-keyword kw">end</span>&#x000A;152:         <span class="ruby-keyword kw">end</span>&#x000A;153:         <span class="ruby-identifier">attributes</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">empty?</span>&#x000A;154:         <span class="ruby-identifier">attributes</span>&#x000A;155:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000151'>
                <a name='M000151'>      </a>
                <div class='synopsis'>
                  <span class='name'>list_domains</span>
                  <span class='arguments'>(max = nil, token = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000151-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000151-source'>    <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 36</span>&#x000A;36:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">list_domains</span>(<span class="ruby-identifier">max</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;37:         <span class="ruby-identifier">params</span> = { <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'ListDomains'</span> }&#x000A;38:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'NextToken'</span>] =&#x000A;39:           <span class="ruby-identifier">token</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">empty?</span>&#x000A;40:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'MaxNumberOfDomains'</span>] =&#x000A;41:           <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">max</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;42:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">params</span>)&#x000A;43:         <span class="ruby-identifier">results</span> = []&#x000A;44:         <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">'//DomainName/text()'</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">domain</span><span class="ruby-operator">|</span>&#x000A;45:           <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>&#x000A;46:         <span class="ruby-keyword kw">end</span>&#x000A;47:         <span class="ruby-comment cmt">#return results, REXML::XPath.first(doc, '//NextToken/text()').to_s</span>&#x000A;48:         <span class="ruby-identifier">results</span>&#x000A;49:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000157'>
                <a name='M000157'>      </a>
                <div class='synopsis'>
                  <span class='name'>put</span>
                  <span class='arguments'>(domain, item, attributes, replace = true)</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="SDB.html#M000156">put_attributes</a>
                  </p>
                </div>
              </div>
              <div class='method public-instance' id='method-M000156'>
                <a name='M000156'>      </a>
                <div class='synopsis'>
                  <span class='name'>put_attributes</span>
                  <span class='arguments'>(domain, item, attributes, replace = true)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000156-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000156-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 112</span>&#x000A;112:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">put_attributes</span>(<span class="ruby-identifier">domain</span>, <span class="ruby-identifier">item</span>, <span class="ruby-identifier">attributes</span>, <span class="ruby-identifier">replace</span> = <span class="ruby-keyword kw">true</span>)&#x000A;113:         <span class="ruby-identifier">replace</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">replace</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">:replace</span>&#x000A;114:         <span class="ruby-identifier">params</span> = {&#x000A;115:           <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'PutAttributes'</span>,&#x000A;116:           <span class="ruby-value str">'DomainName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">domain</span>.<span class="ruby-identifier">to_s</span>,&#x000A;117:           <span class="ruby-value str">'ItemName'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">item</span>.<span class="ruby-identifier">to_s</span>&#x000A;118:         }&#x000A;119:         <span class="ruby-identifier">count</span> = <span class="ruby-value">0</span>&#x000A;120:         &#x000A;121:         <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>, <span class="ruby-identifier">values</span> <span class="ruby-operator">|</span>&#x000A;122:           ([]<span class="ruby-operator">&lt;&lt;</span><span class="ruby-identifier">values</span>).<span class="ruby-identifier">flatten</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">value</span><span class="ruby-operator">|</span>&#x000A;123:             <span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;Attribute.#{count}.Name&quot;</span>] = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>&#x000A;124:             <span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;Attribute.#{count}.Value&quot;</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>&#x000A;125:             <span class="ruby-identifier">params</span>[<span class="ruby-node">&quot;Attribute.#{count}.Replace&quot;</span>] = <span class="ruby-identifier">replace</span>&#x000A;126:             <span class="ruby-identifier">count</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;127:           <span class="ruby-keyword kw">end</span>&#x000A;128:         <span class="ruby-keyword kw">end</span>&#x000A;129:         &#x000A;130:         <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:put</span>, <span class="ruby-identifier">params</span>)&#x000A;131:         &#x000A;132:         <span class="ruby-keyword kw">true</span>&#x000A;133:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000155'>
                <a name='M000155'>      </a>
                <div class='synopsis'>
                  <span class='name'>select</span>
                  <span class='arguments'>(select, token = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000155-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000155-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 78</span>&#x000A; 78:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select</span>(<span class="ruby-identifier">select</span>, <span class="ruby-identifier">token</span> = <span class="ruby-keyword kw">nil</span>)&#x000A; 79:         <span class="ruby-identifier">params</span> = {&#x000A; 80:           <span class="ruby-value str">'Action'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'Select'</span>,&#x000A; 81:           <span class="ruby-value str">'SelectExpression'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">select</span>,&#x000A; 82:         }&#x000A; 83:         <span class="ruby-identifier">params</span>[<span class="ruby-value str">'NextToken'</span>] =&#x000A; 84:           <span class="ruby-identifier">token</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">token</span>.<span class="ruby-identifier">empty?</span>&#x000A; 85:           &#x000A; 86:         <span class="ruby-identifier">doc</span> = <span class="ruby-identifier">call</span>(<span class="ruby-identifier">:get</span>, <span class="ruby-identifier">params</span>)&#x000A; 87:         <span class="ruby-identifier">results</span> = []&#x000A; 88:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">doc</span>&#x000A; 89:           <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">doc</span>, <span class="ruby-value str">&quot;//Item&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A; 90:             <span class="ruby-identifier">name</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">item</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A; 91: &#x000A; 92:             <span class="ruby-identifier">attributes</span> = {<span class="ruby-value str">'Name'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">name</span>}&#x000A; 93:             <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">item</span>, <span class="ruby-value str">&quot;./Attribute&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr</span><span class="ruby-operator">|</span>&#x000A; 94:               <span class="ruby-identifier">key</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Name/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A; 95:               <span class="ruby-identifier">value</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">XPath</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">attr</span>, <span class="ruby-value str">'./Value/text()'</span>).<span class="ruby-identifier">to_s</span>&#x000A; 96:               ( <span class="ruby-identifier">attributes</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">||=</span> [] ) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>&#x000A; 97:             <span class="ruby-keyword kw">end</span>&#x000A; 98:             <span class="ruby-identifier">results</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">attributes</span>&#x000A; 99:           <span class="ruby-keyword kw">end</span>&#x000A;100:           <span class="ruby-comment cmt">#return results, REXML::XPath.first(doc, '//NextToken/text()').to_s</span>&#x000A;101:         <span class="ruby-keyword kw">end</span>&#x000A;102:         &#x000A;103:         <span class="ruby-identifier">hash_results</span> = {}&#x000A;104:         <span class="ruby-identifier">results</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">item</span><span class="ruby-operator">|</span>&#x000A;105:           <span class="ruby-identifier">hash_results</span>[<span class="ruby-identifier">item</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value str">'Name'</span>)] = <span class="ruby-identifier">item</span>&#x000A;106:         <span class="ruby-keyword kw">end</span>&#x000A;107:         &#x000A;108:         <span class="ruby-identifier">hash_results</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">hash_results</span>&#x000A;109:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Protected instance methods</h2>
              <div class='method protected-instance' id='method-M000163'>
                <a name='M000163'>      </a>
                <div class='synopsis'>
                  <span class='name'>call</span>
                  <span class='arguments'>(method, params)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000163-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000163-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 204</span>&#x000A;204:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">call</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">params</span>)&#x000A;205:         <span class="ruby-identifier">params</span>.<span class="ruby-identifier">merge!</span>( {&#x000A;206:             <span class="ruby-value str">'Version'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'2007-11-07'</span>,&#x000A;207:             <span class="ruby-value str">'SignatureVersion'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'1'</span>,&#x000A;208:             <span class="ruby-value str">'AWSAccessKeyId'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@access_key_id</span>,&#x000A;209:             <span class="ruby-value str">'Timestamp'</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">gmtime</span>.<span class="ruby-identifier">iso8601</span>&#x000A;210:           }&#x000A;211:         )&#x000A;212:         <span class="ruby-identifier">data</span> = <span class="ruby-value str">''</span>&#x000A;213:         <span class="ruby-identifier">query</span> = []&#x000A;214:         &#x000A;215:         <span class="ruby-identifier">params</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span>.<span class="ruby-identifier">upcase</span> }.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>&#x000A;216:           <span class="ruby-identifier">data</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{key}#{params[key].to_s}&quot;</span>&#x000A;217:           <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{key}=#{CGI::escape(params[key].to_s)}&quot;</span>&#x000A;218:         <span class="ruby-keyword kw">end</span>&#x000A;219:         &#x000A;220:         <span class="ruby-identifier">digest</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'sha1'</span>)&#x000A;221:         <span class="ruby-identifier">hmac</span> = <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-identifier">digest</span>, <span class="ruby-ivar">@secret_access_key</span>, <span class="ruby-identifier">data</span>)&#x000A;222:         <span class="ruby-identifier">signature</span> = <span class="ruby-constant">Base64</span>.<span class="ruby-identifier">encode64</span>(<span class="ruby-identifier">hmac</span>).<span class="ruby-identifier">strip</span>&#x000A;223:         <span class="ruby-identifier">query</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;Signature=#{CGI::escape(signature)}&quot;</span>&#x000A;224:         <span class="ruby-identifier">query</span> = <span class="ruby-identifier">query</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">'&amp;'</span>)&#x000A;225:         <span class="ruby-identifier">url</span> = <span class="ruby-node">&quot;#{@base_url}?#{query}&quot;</span>&#x000A;226:         <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">url</span>)&#x000A;227:         &#x000A;228:         <span class="ruby-comment cmt">#Rudy::Huxtable.ld url if Rudy.debug?</span>&#x000A;229:         &#x000A;230:         <span class="ruby-identifier">response</span> = <span class="ruby-identifier">execute_request</span>(<span class="ruby-keyword kw">nil</span>) {&#x000A;231:           <span class="ruby-constant">Net</span><span class="ruby-operator">::</span><span class="ruby-constant">HTTP</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>).<span class="ruby-identifier">send_request</span>(<span class="ruby-identifier">method</span>, <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">request_uri</span>)&#x000A;232:         }&#x000A;233:         &#x000A;234:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">response</span>.<span class="ruby-identifier">nil?</span>&#x000A;235:         &#x000A;236:           <span class="ruby-ivar">@debug</span>.<span class="ruby-identifier">puts</span>(<span class="ruby-node">&quot;#{response.code}\n#{response.body}&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@debug</span>&#x000A;237:           <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ConnectionError</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">response</span>)) <span class="ruby-keyword kw">unless</span> (<span class="ruby-value">200</span><span class="ruby-operator">..</span><span class="ruby-value">400</span>).<span class="ruby-identifier">include?</span>(&#x000A;238:             <span class="ruby-identifier">response</span>.<span class="ruby-identifier">code</span>.<span class="ruby-identifier">to_i</span>&#x000A;239:           )&#x000A;240: &#x000A;241: &#x000A;242:           <span class="ruby-identifier">doc</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">body</span>)&#x000A;243:           <span class="ruby-identifier">error</span> = <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-value str">'*/Errors/Error'</span>)[<span class="ruby-value">0</span>]&#x000A;244:           <span class="ruby-identifier">raise</span>(&#x000A;245:             <span class="ruby-constant">Module</span>.<span class="ruby-identifier">class_eval</span>(&#x000A;246:               <span class="ruby-node">&quot;Rudy::AWS::SDB::#{error.get_elements('Code')[0].text}Error&quot;</span>&#x000A;247:             ).<span class="ruby-identifier">new</span>(&#x000A;248:               <span class="ruby-identifier">error</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-value str">'Message'</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">text</span>,&#x000A;249:               <span class="ruby-identifier">doc</span>.<span class="ruby-identifier">get_elements</span>(<span class="ruby-value str">'*/RequestID'</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">text</span>&#x000A;250:             )&#x000A;251:           ) <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">error</span>.<span class="ruby-identifier">nil?</span>&#x000A;252:         <span class="ruby-keyword kw">else</span>&#x000A;253:           <span class="ruby-identifier">doc</span> = <span class="ruby-keyword kw">nil</span>&#x000A;254:         <span class="ruby-keyword kw">end</span>&#x000A;255:         <span class="ruby-identifier">doc</span>&#x000A;256:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M000162'>
                <a name='M000162'>      </a>
                <div class='synopsis'>
                  <span class='name'>execute_request</span>
                  <span class='arguments'>(default=nil, timeout=nil, &amp;request)</span>
                </div>
                <div class='description'>
                  <p>
                  Execute <a href="../AWS.html">AWS</a> requests safely. This will trap
                  errors and return a default value (if specified).
                  </p>
                  <ul>
                  <li><tt>default</tt> A default response value
                  
                  </li>
                  <li><tt>request</tt> A block which contains the <a href="../AWS.html">AWS</a>
                  request
                  
                  </li>
                  </ul>
                  <p>
                  Returns the return value from the request is returned untouched or the
                  default value on error or if the request returned nil.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000162-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000162-source'>     <span class="ruby-comment cmt"># File lib/rudy/aws/sdb.rb, line 183</span>&#x000A;183:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">execute_request</span>(<span class="ruby-identifier">default</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">timeout</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">request</span>)&#x000A;184:         <span class="ruby-identifier">timeout</span> <span class="ruby-operator">||=</span> <span class="ruby-value">30</span>&#x000A;185:         <span class="ruby-identifier">raise</span> <span class="ruby-value str">&quot;No block provided&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">request</span>&#x000A;186:         <span class="ruby-identifier">response</span> = <span class="ruby-keyword kw">nil</span>&#x000A;187:         <span class="ruby-keyword kw">begin</span>&#x000A;188:           <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-identifier">timeout</span>(<span class="ruby-identifier">timeout</span>) <span class="ruby-keyword kw">do</span>&#x000A;189:             <span class="ruby-identifier">response</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">call</span>&#x000A;190:           <span class="ruby-keyword kw">end</span>&#x000A;191: &#x000A;192:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">Timeout</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;193:           <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">Huxtable</span>.<span class="ruby-identifier">le</span> <span class="ruby-node">&quot;Timeout (#{timeout}): #{ex.message}!&quot;</span>&#x000A;194:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SocketError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>&#x000A;195:           <span class="ruby-comment cmt">#Rudy::Huxtable.le ex.message</span>&#x000A;196:           <span class="ruby-comment cmt">#Rudy::Huxtable.le ex.backtrace</span>&#x000A;197:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">SocketError</span>, <span class="ruby-value str">&quot;Check your Internets!&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">Rudy</span><span class="ruby-operator">::</span><span class="ruby-constant">Huxtable</span>.<span class="ruby-identifier">global</span>.<span class="ruby-identifier">offline</span>&#x000A;198:         <span class="ruby-keyword kw">ensure</span>&#x000A;199:           <span class="ruby-identifier">response</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">default</span>&#x000A;200:         <span class="ruby-keyword kw">end</span>&#x000A;201:         <span class="ruby-identifier">response</span>&#x000A;202:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
